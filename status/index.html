<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.5">
  <title>KY Secret Â· å®æ—¶æœåŠ¡çŠ¶æ€</title>
  <style>
    /* æç®€ Â· çº¯çŠ¶æ€ç›‘æ§ â€” æ— æ—¶é—´è½´ã€æ— å†å²åŒ…è¢± */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    }

    body {
      background: #f9fcff;
      color: #152b42;
      line-height: 1.5;
    }

    .container {
      max-width: 780px;
      margin: 0 auto;
      padding: 2rem 1.2rem;
    }

    /* å“ç‰ŒåŒº â€”â€” å®‰é™æœ‰åŠ› */
    .header {
      text-align: center;
      margin-bottom: 2.5rem;
    }

    .logo {
      font-size: 5rem;
      font-weight: 900;
      color: #0a1c2f;
      letter-spacing: -0.02em;
      margin-bottom: 0.5rem;
      line-height: 1;
    }

    .nav-buttons {
      display: flex;
      gap: 0.75rem;
      justify-content: center;
      margin-bottom: 1.75rem;
    }

    .nav-btn {
      padding: 0.5rem 1.4rem;
      border: 1px solid #dae2ed;
      border-radius: 100px;
      background: #ffffff;
      color: #2c4763;
      text-decoration: none;
      font-size: 0.9rem;
      font-weight: 540;
      transition: all 0.2s;
      box-shadow: 0 1px 2px rgba(0,0,0,0.02);
    }

    .nav-btn.active {
      background: #0f2b3f;
      color: white;
      border-color: #0f2b3f;
    }

    .nav-btn:hover {
      background: #ecf3fa;
    }

    .nav-btn.active:hover {
      background: #1c405a;
    }

    /* å®æ—¶çŠ¶æ€å¤§æ¨ªå¹… â€”â€” ä¸€ç›®äº†ç„¶ */
    .global-status-banner {
      background: #f1f7fd;
      border-radius: 60px;
      padding: 0.9rem 1.5rem;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.6rem;
      margin: 0 auto 0.5rem;
      font-size: 0.9rem;
      font-weight: 550;
      color: #1e3f5c;
      border: 1px solid #dde9f5;
      backdrop-filter: blur(4px);
    }

    .global-dot {
      width: 12px;
      height: 12px;
      border-radius: 12px;
      background: #94a3b8;
    }

    .global-dot.ok { background: #0f7b4b; }
    .global-dot.degraded { background: #e68a2e; }
    .global-dot.down { background: #c62a2a; }

    /* æœåŠ¡å¡ç‰‡ â€”â€” å¹²å‡€æ— å†—ä½™ */
    .section {
      background: white;
      border-radius: 28px;
      margin-bottom: 1.8rem;
      border: 1px solid #e6eff8;
      overflow: hidden;
      box-shadow: 0 4px 12px rgba(0, 20, 40, 0.02);
    }

    .section-header {
      padding: 1.2rem 1.5rem 0.5rem 1.5rem;
      font-size: 1.05rem;
      font-weight: 680;
      color: #173246;
      display: flex;
      align-items: center;
      letter-spacing: -0.2px;
    }

    .section-header span {
      background: #ecf3fa;
      padding: 0.2rem 0.8rem;
      border-radius: 30px;
      font-size: 0.7rem;
      font-weight: 600;
      color: #2a5779;
      margin-left: 0.7rem;
    }

    /* æœåŠ¡é¡¹ â€”â€” çº¯ç²¹çŠ¶æ€ + æœåŠ¡å + å®æ—¶æ£€æµ‹ */
    .service-list {
      padding: 0.2rem 0.2rem 0.8rem 0.2rem;
    }

    .service-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 1rem 1.5rem;
      margin: 0.2rem 0.4rem;
      border-radius: 18px;
      background: #ffffff;
      transition: background 0.15s;
    }

    /* è½»å¾®æ–‘é©¬çº¿ï¼Œæ˜“è¯» */
    .service-item:nth-child(even) {
      background: #fafdff;
    }

    .service-left {
      display: flex;
      align-items: center;
      gap: 0.9rem;
      flex-wrap: wrap;
    }

    .status-indicator {
      width: 14px;
      height: 14px;
      border-radius: 14px;
      background: #cbd5e1;
      transition: background 0.2s ease;
      box-shadow: 0 0 0 1px rgba(255,255,255,0.8);
    }

    /* çŠ¶æ€é¢œè‰² â€”â€” ç›´è§‚æ¸…æ™° */
    .status-indicator.operational { background: #0a8f5a; box-shadow: 0 0 0 2px rgba(10,143,90,0.1); }
    .status-indicator.degraded { background: #e68a2e; box-shadow: 0 0 0 2px rgba(230,138,46,0.1); }
    .status-indicator.down { background: #cd3c30; box-shadow: 0 0 0 2px rgba(205,60,48,0.1); }
    .status-indicator.unknown { background: #94a3b8; }

    .service-name {
      font-weight: 570;
      color: #0e2f44;
      font-size: 0.98rem;
    }

    .service-endpoint {
      font-size: 0.7rem;
      color: #607b96;
      background: #eef4fa;
      padding: 0.2rem 0.7rem;
      border-radius: 40px;
      font-family: monospace;
    }

    .status-text {
      font-weight: 640;
      font-size: 0.85rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .status-badge {
      padding: 0.3rem 0.9rem;
      border-radius: 100px;
      font-size: 0.75rem;
      font-weight: 650;
      text-transform: uppercase;
      letter-spacing: 0.3px;
    }

    .badge-operational {
      background: #e1f7ed;
      color: #0a6d47;
    }

    .badge-degraded {
      background: #ffeed9;
      color: #a3500a;
    }

    .badge-down {
      background: #ffe6e5;
      color: #b11f1a;
    }

    .badge-unknown {
      background: #edf2f7;
      color: #4a627a;
    }

    /* æ£€æµ‹æ—¶é—´ & åˆ·æ–°æ§ä»¶ */
    .check-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 0.8rem;
      padding: 1rem 1.5rem 1.2rem 1.5rem;
      border-top: 1px solid #e6edf4;
      color: #5a7188;
      font-size: 0.78rem;
      flex-wrap: wrap;
    }

    .last-check {
      display: flex;
      align-items: center;
      gap: 0.4rem;
    }

    .refresh-btn {
      background: white;
      border: 1px solid #cde0ed;
      padding: 0.4rem 1.1rem;
      border-radius: 60px;
      font-size: 0.75rem;
      font-weight: 600;
      color: #1c4e6e;
      cursor: pointer;
      transition: 0.15s;
      display: flex;
      align-items: center;
      gap: 0.4rem;
    }

    .refresh-btn:hover {
      background: #e7f0f9;
      border-color: #95b3cc;
    }

    .refresh-btn:active {
      background: #d0e2f0;
    }

    /* ç¦»çº¿è¯Šæ–­æç¤º â€”â€” è½»é‡ */
    .degraded-hint {
      font-size: 0.7rem;
      color: #b76a1a;
      background: #fff1e0;
      padding: 0.2rem 0.8rem;
      border-radius: 30px;
      margin-left: 0.6rem;
    }

    /* ç§»åŠ¨è°ƒæ•´ */
    @media (max-width: 550px) {
      .container { padding: 1.5rem 1rem; }
      .logo { font-size: 4rem; }
      .service-item { flex-wrap: wrap; gap: 0.6rem; }
      .status-text { width: 100%; margin-left: 1.8rem; }
    }

    /* çº¯ç²¹çŠ¶æ€é¡µ â€” æ— æ—¶é—´è½´ï¼Œæ— å†å²å¡ç‰‡ï¼Œåªåšå®æ—¶æ£€æµ‹ */
  </style>
</head>
<body>
  <div class="container">
    <!-- å¤´éƒ¨ â€”â€” å†å²æŒ‰é’®ä¿ç•™ä½†éæ¿€æ´»ï¼Œå½“å‰ä¸ºçŠ¶æ€é¡µ -->
    <div class="header">
      <div class="logo">KYSECRET</div>
      <div class="nav-buttons">
        <a href="./index.html" class="nav-btn active">ğŸ“Š çŠ¶æ€</a>
        <a href="./history.html" class="nav-btn">ğŸ“‹ å†å²</a>
      </div>

      <!-- å…¨å±€å¥åº·çŠ¶æ€åŠ¨æ€æ˜¾ç¤º (é€šè¿‡jsæ›´æ–°) -->
      <div id="globalBanner" class="global-status-banner">
        <span id="globalDot" class="global-dot"></span>
        <span id="globalMessage">æ­£åœ¨æ£€æµ‹æœåŠ¡çŠ¶æ€...</span>
      </div>
    </div>

    <!-- ========= å‰ç«¯æœåŠ¡ç»„ ========= -->
    <div class="section">
      <div class="section-header">
        ğŸŒ å‰ç«¯æ‰˜ç®¡
        <span id="frontend-count">2 æœåŠ¡</span>
      </div>
      <div class="service-list">
        <!-- Cloudflare Pages -->
        <div class="service-item" id="service-cf">
          <div class="service-left">
            <span class="status-indicator" id="indicator-cf"></span>
            <span class="service-name">Cloudflare Pages</span>
            <span class="service-endpoint">pages.kysecret.dev</span>
          </div>
          <div class="status-text">
            <span id="status-badge-cf" class="status-badge badge-operational">æ£€æµ‹ä¸­...</span>
          </div>
        </div>
        <!-- GitHub ä»“åº“ Â· é™æ€èµ„æº -->
        <div class="service-item" id="service-gh">
          <div class="service-left">
            <span class="status-indicator" id="indicator-gh"></span>
            <span class="service-name">GitHub ä»“åº“</span>
            <span class="service-endpoint">github.com/kysecret/web</span>
          </div>
          <div class="status-text">
            <span id="status-badge-gh" class="status-badge badge-operational">æ£€æµ‹ä¸­...</span>
          </div>
        </div>
      </div>
    </div>

    <!-- ========= åç«¯æ ¸å¿ƒ ========= -->
    <div class="section">
      <div class="section-header">
        âš™ï¸ åç«¯æ ¸å¿ƒ
        <span id="backend-count">2 æœåŠ¡</span>
      </div>
      <div class="service-list">
        <!-- Backend API -->
        <div class="service-item" id="service-api">
          <div class="service-left">
            <span class="status-indicator" id="indicator-api"></span>
            <span class="service-name">Backend API</span>
            <span class="service-endpoint">api.kysecret.com/v1</span>
          </div>
          <div class="status-text">
            <span id="status-badge-api" class="status-badge badge-down">ç¦»çº¿</span>
            <span class="degraded-hint" id="hint-api"></span>
          </div>
        </div>
        <!-- æäº¤æœåŠ¡ Submission -->
        <div class="service-item" id="service-sub">
          <div class="service-left">
            <span class="status-indicator" id="indicator-sub"></span>
            <span class="service-name">æäº¤æœåŠ¡ (Submission)</span>
            <span class="service-endpoint">submit.kysecret.com</span>
          </div>
          <div class="status-text">
            <span id="status-badge-sub" class="status-badge badge-down">ç¦»çº¿</span>
            <span class="degraded-hint" id="hint-sub"></span>
          </div>
        </div>
      </div>
    </div>

    <!-- ========= ç®¡ç†åå° ========= -->
    <div class="section">
      <div class="section-header">
        ğŸ” ç®¡ç†åå°
        <span id="admin-count">2 æœåŠ¡</span>
      </div>
      <div class="service-list">
        <!-- Admin Login -->
        <div class="service-item" id="service-login">
          <div class="service-left">
            <span class="status-indicator" id="indicator-login"></span>
            <span class="service-name">Admin ç™»å½•</span>
            <span class="service-endpoint">admin.kysecret.com/login</span>
          </div>
          <div class="status-text">
            <span id="status-badge-login" class="status-badge badge-operational">æ­£å¸¸</span>
          </div>
        </div>
        <!-- Admin Dashboard -->
        <div class="service-item" id="service-dash">
          <div class="service-left">
            <span class="status-indicator" id="indicator-dash"></span>
            <span class="service-name">Admin ä»ªè¡¨æ¿</span>
            <span class="service-endpoint">admin.kysecret.com/dash</span>
          </div>
          <div class="status-text">
            <span id="status-badge-dash" class="status-badge badge-down">ä¸å¯ç”¨</span>
            <span class="degraded-hint" id="hint-dash"></span>
          </div>
        </div>
      </div>

      <!-- æ£€æµ‹ä¿¡æ¯æ  â€”â€” å®æ—¶åˆ·æ–°ï¼Œæ— æ—¶é—´è½´ï¼Œæ— å†å²åŒ…è¢± -->
      <div class="check-footer">
        <div class="last-check">
          <span>ğŸ•’ æœ€åæ£€æµ‹: </span>
          <span id="lastCheckTime">åˆšåˆš</span>
        </div>
        <div id="manualRefreshBtn" class="refresh-btn">
          <span>âŸ³</span> ç«‹å³æ£€æµ‹
        </div>
      </div>
    </div>

    <!-- æç®€è„šæ³¨ -->
    <div style="text-align: center; padding: 1.8rem 0 0.2rem; color: #6e889c; font-size: 0.75rem; border-top: 1px solid #dfecf5; margin-top: 1rem;">
      KY Secret Â· å®æ—¶çŠ¶æ€æ£€æµ‹ (æ¯60ç§’è‡ªåŠ¨åˆ·æ–°) Â· æ¨¡æ‹Ÿæ•…éšœæ³¨å…¥å·²å¯ç”¨
    </div>
  </div>

  <script>
    (function() {
      "use strict";

      // ------------------------------------------------------------
      // KY Secret å®æ—¶çŠ¶æ€æ£€æµ‹ JS â€” çº¯å‰ç«¯æ¨¡æ‹Ÿ + çœŸå®æ¢æµ‹éª¨æ¶
      // è®¾è®¡ç›®æ ‡ï¼šåªæ˜¾ç¤ºå½“å‰çŠ¶æ€ï¼Œæ— æ—¶é—´è½´ã€‚å¯é€šè¿‡fetchçœŸå®æ£€æµ‹ï¼Œç°ä¸ºæ¨¡æ‹Ÿã€‚
      // ä½†ä¿ç•™çœŸå®æ£€æµ‹èƒ½åŠ›ï¼šåªéœ€æ›¿æ¢æ¨¡æ‹Ÿéƒ¨åˆ†å³å¯æ¥å…¥çœŸå®å¥åº·æ£€æŸ¥ã€‚
      // ------------------------------------------------------------

      // ---------- æœåŠ¡é…ç½® ----------
      const SERVICES = [
        { id: 'cf', name: 'Cloudflare Pages', endpoint: 'https://pages.kysecret.dev/health', normal: true, type: 'frontend' },
        { id: 'gh', name: 'GitHub ä»“åº“', endpoint: 'https://raw.githubusercontent.com/kysecret/web/readme', normal: true, type: 'frontend' },
        { id: 'api', name: 'Backend API', endpoint: 'https://api.kysecret.com/v1/ping', normal: false, type: 'backend' },
        { id: 'sub', name: 'æäº¤æœåŠ¡', endpoint: 'https://submit.kysecret.com/status', normal: false, type: 'backend' },
        { id: 'login', name: 'Admin ç™»å½•', endpoint: 'https://admin.kysecret.com/login/health', normal: true, type: 'admin' },
        { id: 'dash', name: 'Admin ä»ªè¡¨æ¿', endpoint: 'https://admin.kysecret.com/dash/api/health', normal: false, type: 'admin' }
      ];

      // çŠ¶æ€æšä¸¾
      const STATUS = {
        OPERATIONAL: 'operational',
        DEGRADED: 'degraded',
        DOWN: 'down',
        UNKNOWN: 'unknown'
      };

      // å½“å‰æ£€æµ‹ç»“æœå­˜å‚¨
      let currentStatus = {
        cf: STATUS.OPERATIONAL,
        gh: STATUS.OPERATIONAL,
        api: STATUS.DOWN,
        sub: STATUS.DOWN,
        login: STATUS.OPERATIONAL,
        dash: STATUS.DOWN
      };

      // é™„åŠ æ¶ˆæ¯ (å¦‚å»¶è¿Ÿ/é”™è¯¯è¯¦æƒ…)
      let statusMessages = {
        api: 'è¿æ¥è¶…æ—¶',
        sub: '5xx é”™è¯¯',
        dash: 'æœåŠ¡æœªå“åº”',
        cf: '',
        gh: '',
        login: ''
      };

      // æœ€åä¸€æ¬¡æ£€æµ‹æ—¶é—´
      let lastCheckTimestamp = Date.now();

      // ---------- UI æ›´æ–°å‡½æ•° ----------
      function updateAllUI() {
        // æ›´æ–°æ¯ä¸ªæœåŠ¡çš„æŒ‡ç¤ºå™¨ + å¾½ç«  + æç¤º
        SERVICES.forEach(service => {
          const id = service.id;
          const state = currentStatus[id] || STATUS.UNKNOWN;
          const msg = statusMessages[id] || '';

          // çŠ¶æ€æŒ‡ç¤ºç‚¹
          const indicator = document.getElementById(`indicator-${id}`);
          if (indicator) {
            indicator.className = 'status-indicator'; // reset
            indicator.classList.add(state);
          }

          // çŠ¶æ€å¾½ç« 
          const badge = document.getElementById(`status-badge-${id}`);
          if (badge) {
            let text = '';
            let badgeClass = '';
            switch (state) {
              case STATUS.OPERATIONAL:
                text = 'æ­£å¸¸';
                badgeClass = 'badge-operational';
                break;
              case STATUS.DEGRADED:
                text = 'é™çº§';
                badgeClass = 'badge-degraded';
                break;
              case STATUS.DOWN:
                text = 'ç¦»çº¿';
                badgeClass = 'badge-down';
                break;
              default:
                text = 'æœªçŸ¥';
                badgeClass = 'badge-unknown';
            }
            badge.innerText = text;
            badge.className = 'status-badge ' + badgeClass;
          }

          // é¢å¤–æç¤ºï¼ˆé”™è¯¯ä¿¡æ¯/é™çº§åŸå› ï¼‰
          const hintEl = document.getElementById(`hint-${id}`);
          if (hintEl) {
            hintEl.innerText = msg || '';
            if (!msg) hintEl.style.display = 'none';
            else hintEl.style.display = 'inline-block';
          }
        });

        // æ›´æ–°å…¨å±€æ¨ªå¹…
        updateGlobalBanner();

        // æ›´æ–°æ—¶é—´æˆ³
        const lastTimeEl = document.getElementById('lastCheckTime');
        if (lastTimeEl) {
          const date = new Date(lastCheckTimestamp);
          const timeStr = `${date.getHours().toString().padStart(2,'0')}:${date.getMinutes().toString().padStart(2,'0')}:${date.getSeconds().toString().padStart(2,'0')}`;
          lastTimeEl.innerText = timeStr;
        }
      }

      // å…¨å±€æ¦‚è§ˆçŠ¶æ€
      function updateGlobalBanner() {
        const dot = document.getElementById('globalDot');
        const msg = document.getElementById('globalMessage');

        // è®¡ç®—å…¨å±€ï¼šåªè¦æœ‰ä¸€ä¸ªdown => æ€»ä½“ç¦»çº¿ï¼›æœ‰degradedæ— down => é™çº§ï¼›å…¨operational => æ­£å¸¸
        let hasDown = false, hasDegraded = false, hasUnknown = false;
        SERVICES.forEach(s => {
          const state = currentStatus[s.id] || STATUS.UNKNOWN;
          if (state === STATUS.DOWN) hasDown = true;
          else if (state === STATUS.DEGRADED) hasDegraded = true;
          else if (state === STATUS.UNKNOWN) hasUnknown = true;
        });

        if (hasDown) {
          dot.className = 'global-dot down';
          msg.innerText = 'éƒ¨åˆ†æœåŠ¡ç¦»çº¿ Â· å®æ—¶çŠ¶æ€';
        } else if (hasDegraded) {
          dot.className = 'global-dot degraded';
          msg.innerText = 'æœåŠ¡é™çº§ Â· æ€§èƒ½ä¸‹é™';
        } else if (hasUnknown) {
          dot.className = 'global-dot unknown';
          msg.innerText = 'éƒ¨åˆ†çŠ¶æ€æœªçŸ¥';
        } else {
          dot.className = 'global-dot ok';
          msg.innerText = 'æ‰€æœ‰ç³»ç»Ÿæ­£å¸¸ Â· è¿è¡Œä¸­';
        }
      }

      // ---------- æ ¸å¿ƒæ£€æµ‹é€»è¾‘ ----------
      // çº¯å‰ç«¯æ¨¡æ‹Ÿ: çœŸå®æƒ…å†µä¸‹ï¼Œæ›¿æ¢æ­¤å‡½æ•°ä¸ºçœŸå®fetchå³å¯ã€‚
      // æˆ‘ä»¬ä¿ç•™æ¨¡æ‹Ÿçš„æ•…éšœçŠ¶æ€: åç«¯api/sub/dashç¦»çº¿ï¼Œå‰ç«¯å’Œç®¡ç†å‘˜ç™»å½•æ­£å¸¸ã€‚
      // åŒæ—¶å¯éšæœºäº§ç”Ÿé™çº§/ç¦»çº¿ï¼ˆæ¼”ç¤ºåŠ¨æ€æ£€æµ‹ï¼‰
      function performHealthCheck() {
        // æ¨¡æ‹Ÿæ£€æµ‹è¿‡ç¨‹
        return new Promise((resolve) => {
          // æ¨¡æ‹Ÿç½‘ç»œå»¶è¿Ÿ 200~400ms
          setTimeout(() => {
            // åŸºç¡€çŠ¶æ€ â€”â€” å¤§éƒ¨åˆ†ä¸é¢„è®¾ä¸€è‡´ï¼Œä½†åŠ å…¥ä¸€äº›åŠ¨æ€å˜åŒ–ä»¥ä½“ç°æ£€æµ‹æ•ˆæœ
            // æ¯”å¦‚: å¶å°”è®© Cloudflare Pages å˜æˆé™çº§ (5%æ¦‚ç‡)ï¼Œä½†ä¸ºäº†æ¸…æ™°æ¼”ç¤ºï¼Œæˆ‘ä»¬è®¾å®šç¨³å®šçŠ¶æ€ï¼Œä½†ä¿ç•™å˜åŒ–å¯èƒ½æ€§ã€‚
            
            // ç¨³å®šçŠ¶æ€: ä¸æˆ‘ä»¬è§†è§‰åˆå§‹ä¸€è‡´ï¼›ä½†æ‰‹åŠ¨åˆ·æ–°æ—¶å¯ä»¥çœ‹åˆ°â€œæ£€æµ‹ä¸­â€çš„å˜åŒ–
            // ä¸ºäº†è®©æ¼”ç¤ºæ›´æœ‰è¶£ï¼Œæ¯æ¬¡æ£€æµ‹æœ‰ä¸€å®šæ¦‚ç‡æ”¹å˜ admin dashboard ä¸ºé™çº§/ç¦»çº¿
            const random = Math.random();
            
            // æ ¸å¿ƒçŠ¶æ€: åç«¯ç¦»çº¿ï¼Œadmin dashboard ç¦»çº¿ï¼Œä½†éšæœºæ³¨å…¥å˜åŒ–
            currentStatus = {
              cf: STATUS.OPERATIONAL,   // å‰ç«¯æ°¸è¿œæ­£å¸¸
              gh: STATUS.OPERATIONAL,
              api: STATUS.DOWN,         // ä¿æŒç¦»çº¿ (çœŸå®ç¯å¢ƒç¦»çº¿)
              sub: STATUS.DOWN,
              login: STATUS.OPERATIONAL,
              dash: STATUS.DOWN         // é»˜è®¤ç¦»çº¿ï¼Œä½†éšæœºå¯èƒ½å˜æˆé™çº§
            };

            // æ¼”ç¤ºåŠ¨æ€æ£€æµ‹æ•ˆæœ: Admin Dashboard æœ‰æ—¶å˜ä¸ºé™çº§ï¼Œæœ‰æ—¶è¿˜æ˜¯ç¦»çº¿ (æ›´æœ‰å®æ—¶æ„Ÿ)
            if (random < 0.3) {
              currentStatus.dash = STATUS.DEGRADED;
              statusMessages.dash = 'é«˜å»¶è¿Ÿ (280ms)';
            } else if (random < 0.65) {
              currentStatus.dash = STATUS.DOWN;
              statusMessages.dash = 'è¿æ¥å¤±è´¥';
            } else {
              currentStatus.dash = STATUS.DOWN;  // ä¿æŒç¦»çº¿
              statusMessages.dash = '5xx é”™è¯¯';
            }

            // åç«¯ API å¶å°”ä¹Ÿå˜ä¸ºé™çº§ (æ¦‚ç‡å°) â€” ä½†å¤§éƒ¨åˆ†ç¦»çº¿
            if (Math.random() < 0.2) {
              currentStatus.api = STATUS.DEGRADED;
              statusMessages.api = 'å“åº”ç¼“æ…¢';
            } else {
              currentStatus.api = STATUS.DOWN;
              statusMessages.api = 'è¶…æ—¶/ä¸å¯è¾¾';
            }

            // æäº¤æœåŠ¡ï¼šæœ‰æ—¶é™çº§
            if (Math.random() < 0.25) {
              currentStatus.sub = STATUS.DEGRADED;
              statusMessages.sub = 'éƒ¨åˆ†å¤±è´¥';
            } else {
              currentStatus.sub = STATUS.DOWN;
              statusMessages.sub = 'æ— æ³•è¿æ¥';
            }

            // å‰ç«¯æœåŠ¡å›ºå®šæ­£å¸¸
            statusMessages.cf = '';
            statusMessages.gh = '';
            statusMessages.login = '';

            // æ›´æ–°æ—¶é—´æˆ³
            lastCheckTimestamp = Date.now();
            
            resolve();
          }, 280); // æ¨¡æ‹Ÿæ£€æµ‹è€—æ—¶
        });
      }

      // åˆ·æ–°æ‰€æœ‰çŠ¶æ€å¹¶æ›´æ–°UI
      async function refreshAllStatus() {
        // æ£€æµ‹å‰å¯å°†éƒ¨åˆ†å¾½ç« ç½®ä¸ºâ€œæ£€æµ‹ä¸­â€
        SERVICES.forEach(s => {
          const badge = document.getElementById(`status-badge-${s.id}`);
          if (badge) badge.innerText = 'æ£€æµ‹ä¸­...';
        });
        
        await performHealthCheck();
        updateAllUI();
      }

      // åˆå§‹åŒ– & ç»‘å®šäº‹ä»¶
      async function init() {
        // é¦–æ¬¡æ‰§è¡Œæ£€æµ‹
        await refreshAllStatus();

        // ç»‘å®šæ‰‹åŠ¨åˆ·æ–°æŒ‰é’®
        const refreshBtn = document.getElementById('manualRefreshBtn');
        if (refreshBtn) {
          refreshBtn.addEventListener('click', async function(e) {
            e.preventDefault();
            await refreshAllStatus();
          });
        }

        // è‡ªåŠ¨é—´éš”: æ¯60ç§’æ£€æµ‹ä¸€æ¬¡ (ä¿æŒçŠ¶æ€å®æ—¶)
        setInterval(async () => {
          await refreshAllStatus();
        }, 60000); // 60,000 ms = 1åˆ†é’Ÿ
      }

      init();
    })();
  </script>

  <!-- 
    è®¾è®¡è¯´æ˜:
    - å®Œå…¨ç§»é™¤æ—¶é—´è½´(timeline)ç›¸å…³HTMLã€CSSã€JSä»£ç ã€‚æ— å†å²äº‹ä»¶å ä½ã€‚
    - åªä¿ç•™çŠ¶æ€å¡ç‰‡ã€çŠ¶æ€æŒ‡ç¤ºç‚¹ã€æ£€æµ‹æ—¶é—´ã€æ‰‹åŠ¨åˆ·æ–°ã€‚
    - 6ä¸ªæœåŠ¡ï¼Œå‡æœ‰çœŸå®ç«¯ç‚¹å ä½ï¼Œé€šè¿‡JSæ¨¡æ‹Ÿæ£€æµ‹(ä½†å®Œå…¨å¯æ›¿æ¢ä¸ºfetch)ã€‚
    - å…¨å±€æ¨ªå¹…åæ˜ æ•´ä½“å¥åº·åº¦ã€‚
    - å®æ—¶æ£€æµ‹: æ¯æ¬¡åˆ·æ–°(æ‰‹åŠ¨/è‡ªåŠ¨)éƒ½ä¼šæ”¹å˜éƒ¨åˆ†çŠ¶æ€(å¦‚dashboardé™çº§/ç¦»çº¿æ¦‚ç‡)ï¼Œä½“ç°â€œå®æ—¶ç›‘æµ‹â€ã€‚
    - é›¶å†å²è®°å½•ã€é›¶æ—¶é—´è½´ã€é›¶å†—ä½™æŠ˜å ã€‚ç®€æ´ï¼Œèšç„¦å½“å‰æ˜¯å¦æŒ‚æ‰ã€‚
  -->
</body>
</html>